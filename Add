-- Hub Anti-Lag +FPS

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local Camera = Workspace.CurrentCamera

-- ======= GUI =======
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "AntiLagHub"
ScreenGui.Parent = PlayerGui

local Hub = Instance.new("Frame")
Hub.Size = UDim2.new(0, 200, 0, 100)
Hub.Position = UDim2.new(0.8,0,0.1,0)
Hub.BackgroundColor3 = Color3.fromRGB(50,50,50)
Hub.BackgroundTransparency = 0.5
Hub.Active = true
Hub.Draggable = true
Hub.Parent = ScreenGui

local FPSButton = Instance.new("TextButton")
FPSButton.Size = UDim2.new(0, 180, 0, 50)
FPSButton.Position = UDim2.new(0,10,0,25)
FPSButton.BackgroundColor3 = Color3.fromRGB(255,0,0)
FPSButton.Text = "+FPS"
FPSButton.TextColor3 = Color3.fromRGB(255,255,255)
FPSButton.Font = Enum.Font.SourceSansBold
FPSButton.TextScaled = true
FPSButton.Parent = Hub

local FPSLabel = Instance.new("TextLabel")
FPSLabel.Size = UDim2.new(0,60,0,25)
FPSLabel.Position = UDim2.new(1,10,0,0)
FPSLabel.BackgroundTransparency = 1
FPSLabel.TextColor3 = Color3.fromRGB(255,255,255)
FPSLabel.Font = Enum.Font.SourceSansBold
FPSLabel.TextScaled = true
FPSLabel.Text = "FPS: 0"
FPSLabel.Parent = Hub

-- ======= Anti-lag =======
local AntiLagActive = false

local function disableEffects(obj)
    for _, v in pairs(obj:GetDescendants()) do
        if v:IsA("ParticleEmitter") or v:IsA("Trail") or v:IsA("Smoke") or v:IsA("Fire") then
            v.Enabled = false
        elseif v:IsA("Decal") or v:IsA("Texture") then
            v:Destroy()
        end
    end
end

local function isOnScreen(part)
    local _, onScreen = Camera:WorldToViewportPoint(part.Position)
    return onScreen
end

local function activateAntiLag()
    if AntiLagActive then return end
    AntiLagActive = true

    -- Botão fica verde
    FPSButton.BackgroundColor3 = Color3.fromRGB(0,255,0)

    -- Inicial desativa efeitos do mapa
    disableEffects(Workspace)

    -- Remove objetos gigantes
    for _, obj in pairs(Workspace:GetDescendants()) do
        if obj:IsA("Part") or obj:IsA("MeshPart") then
            if obj.Size.Magnitude > 50 then
                obj:Destroy()
            end
        end
    end

    -- Anti-lag contínuo
    Workspace.DescendantAdded:Connect(function(obj)
        disableEffects(obj)
    end)

    -- Render apenas partes visíveis
    RunService.RenderStepped:Connect(function()
        for _, player in pairs(Players:GetPlayers()) do
            if player.Character then
                for _, part in pairs(player.Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        if player == LocalPlayer then
                            part.Transparency = 0
                        else
                            if not isOnScreen(part) then
                                part.Transparency = 1
                                part.CanCollide = false
                            else
                                part.Transparency = 0
                                part.CanCollide = true
                            end
                        end
                    end
                end
            end
        end
    end)
end

FPSButton.MouseButton1Click:Connect(function()
    activateAntiLag()
end)

-- ======= AFPS =======
local lastTime = tick()
local frameCount = 0
RunService.RenderStepped:Connect(function()
    frameCount = frameCount + 1
    local now = tick()
    if now - lastTime >= 1 then
        FPSLabel.Text = "FPS: "..frameCount
        frameCount = 0
        lastTime = now
    end
end)
